@page
@using System
@using System.Linq
@model IndexModel
@inject Microsoft.AspNetCore.Mvc.Localization.IViewLocalizer T
@inject SysJaky_N.Services.IsoStandards.IIsoSpecializationMetadataProvider IsoMetadataProvider
@{ 
    ViewData["Title"] = T["Title"];
    ViewData["AppContentClasses"] = "container-fluid px-0";

    var specializations = IsoMetadataProvider.GetAll();

    var heroMediaSources = new Dictionary<string, string>
    {
        ["ISO9001"] = Url.Content("~/img/articles/iso9001-preparation.svg"),
        ["ISO14001"] = Url.Content("~/img/articles/process-management.svg"),
        ["ISOIEC17025"] = Url.Content("~/img/articles/internal-audit.svg"),
        ["ISO27001"] = Url.Content("~/img/articles/cert-vs-accred.svg"),
        ["ISO45001"] = Url.Content("~/img/articles/automotive-iso.svg")
    };

    var heroMedia = specializations
        .Where(item => heroMediaSources.ContainsKey(item.Key))
        .Take(3)
        .Select((item, index) => new
        {
            item.Name,
            Image = heroMediaSources[item.Key],
            Accent = index switch
            {
                0 => "primary",
                1 => "secondary",
                _ => "tertiary"
            }
        })
        .ToList();
}

@section Head {
    <link rel="stylesheet" href="~/css/home.css" asp-append-version="true" />
}

<div class="home-experience" data-page="landing">
    <section class="hero" id="hero">
        <div class="hero__backdrop" aria-hidden="true"></div>
        <div class="hero__light hero__light--left" aria-hidden="true"></div>
        <div class="hero__light hero__light--right" aria-hidden="true"></div>
        <div class="hero__inner">
            <div class="hero__content" data-reveal>
                <span class="hero__badge">
                    <i class="bi bi-stars" aria-hidden="true"></i>
                    @T["HeroUSP2"]
                </span>
                <h1>@T["HeroMainHeading"]</h1>
                <p class="hero__lead">@T["HeroSubheading"]</p>

                <div class="hero__usp">
                    <span>
                        <i class="bi bi-patch-check" aria-hidden="true"></i>
                        @T["HeroUSP1"]
                    </span>
                    <span>
                        <i class="bi bi-people" aria-hidden="true"></i>
                        @T["HeroUSP3"]
                    </span>
                </div>

                <div class="hero__actions">
                    <a class="btn btn-primary hero__cta" href="/Courses/Index">
                        <span>@T["HeroPrimaryCTA"]</span>
                        <i class="bi bi-arrow-right" aria-hidden="true"></i>
                    </a>
                    <a class="btn btn-outline-light hero__secondary" href="/Corporate">
                        @T["HeroSecondaryCTA"]
                    </a>
                </div>

                <div class="hero__chips" aria-label="@T["HeroTitle"]">
                    <span class="chip">@T["ChipOnline"]</span>
                    <span class="chip">@T["ChipRetraining"]</span>
                    <span class="chip">@T["ChipCertificate"]</span>
                    <span class="chip">@T["ChipAccreditation"]</span>
                    <span class="chip">@T["ChipInternalAudits"]</span>
                </div>
            </div>

            <aside class="hero__visual" aria-label="@T["HeroSearchLabel"]" data-float>
                <div class="hero__card" data-reveal data-reveal-delay="150">
                    <div class="hero__card-header">
                        <div class="hero__card-badge">
                            <i class="bi bi-shield-check" aria-hidden="true"></i>
                        </div>
                        <div>
                            <div class="hero__card-eyebrow">@T["TrustGuarantee"]</div>
                            <div class="hero__card-title">ISO 9001</div>
                        </div>
                    </div>
                    <div class="hero__card-progress">
                        <div class="progress-group">
                            <div class="progress-label">@T["HeroUSP1"]</div>
                            <div class="progress-bar"><span style="--progress: 90%"></span></div>
                        </div>
                        <div class="progress-group">
                            <div class="progress-label">@T["HeroUSP2"]</div>
                            <div class="progress-bar"><span style="--progress: 80%"></span></div>
                        </div>
                        <div class="progress-group">
                            <div class="progress-label">@T["HeroUSP3"]</div>
                            <div class="progress-bar"><span style="--progress: 88%"></span></div>
                        </div>
                    </div>
                    <dl class="hero__card-insights">
                        <div>
                            <dt><i class="bi bi-award" aria-hidden="true"></i></dt>
                            <dd>@Html.Raw(T["TrustRating", "<strong>4.8/5</strong>"])</dd>
                        </div>
                        <div>
                            <dt><i class="bi bi-people" aria-hidden="true"></i></dt>
                            <dd>@Html.Raw(T["TrustGraduates", "<strong>10 000+</strong>"])</dd>
                        </div>
                        <div>
                            <dt><i class="bi bi-patch-check" aria-hidden="true"></i></dt>
                            <dd>@T["TrustCertificate"]</dd>
                        </div>
                    </dl>
                </div>

                @if (heroMedia.Any())
                {
                    <div class="hero__gallery" aria-hidden="true">
                        @foreach (var media in heroMedia)
                        {
                            <figure class="hero__gallery-item hero__gallery-item--@media.Accent" data-parallax-layer>
                                <img src="@media.Image" alt="" loading="lazy" decoding="async" />
                                <figcaption>@media.Name</figcaption>
                            </figure>
                        }
                    </div>
                }
            </aside>
        </div>

        <div class="hero__search" data-reveal data-reveal-delay="200">
            <form method="get" action="/Courses/Search" role="search">
                <label class="visually-hidden" for="hero-search-input">@T["HeroSearchLabel"]</label>
                <div class="hero__search-field">
                    <i class="bi bi-search" aria-hidden="true"></i>
                    <input type="search"
                           id="hero-search-input"
                           name="query"
                           placeholder="@T["HeroSearchPlaceholder"]"
                           aria-label="@T["HeroSearchAriaLabel"]" />
                </div>
                <button type="submit" class="btn btn-primary hero__search-button">
                    @T["HeroSubmit"]
                </button>
            </form>
        </div>

        <div class="hero__metrics" aria-label="@T["WhyChooseHeading"]">
            <article data-reveal>
                <span class="metric-value">20+</span>
                <span class="metric-label">@T["MetricExperienceLabel"]</span>
            </article>
            <article data-reveal data-reveal-delay="50">
                <span class="metric-value">500+</span>
                <span class="metric-label">@T["MetricClientsLabel"]</span>
            </article>
            <article data-reveal data-reveal-delay="100">
                <span class="metric-value">2000+</span>
                <span class="metric-label">@T["MetricCoursesLabel"]</span>
            </article>
            <article data-reveal data-reveal-delay="150">
                <span class="metric-value">15+</span>
                <span class="metric-label">@T["MetricInstructorsLabel"]</span>
            </article>
        </div>
    </section>

    @await Html.PartialAsync("/Pages/Shared/_SpecializationsSection.cshtml", specializations)

    <section class="section courses" id="courses">
        <header class="section__header" data-reveal>
            <span class="section__eyebrow">@T["RecommendedForYou"]</span>
            <h2>@T["CoursesHeading"]</h2>
            <p>@T["CoursesDescription"]</p>
        </header>

        <div class="courses__layout">
            <div class="courses__grid">
                @if (Model.PicksForPersona.Any())
                {
                    foreach (var course in Model.PicksForPersona)
                    {
                        <article class="course-card" data-reveal>
                            <div class="course-card__top">
                                <div>
                                    <h3>@course.Title</h3>
                                    <span class="badge">@course.Level</span>
                                </div>
                                <span class="course-card__mode">
                                    <i class="bi @(course.Mode.Contains("online", StringComparison.OrdinalIgnoreCase) ? "bi-wifi" : "bi-geo")" aria-hidden="true"></i>
                                    @course.Mode
                                </span>
                            </div>
                            <ul class="course-card__meta">
                                <li><i class="bi bi-geo-alt" aria-hidden="true"></i>@course.Type</li>
                                <li><i class="bi bi-calendar-event" aria-hidden="true"></i>@course.DateDisplay</li>
                            </ul>
                            <div class="course-card__footer">
                                <div>
                                    <span class="course-card__duration">@course.DurationDisplay</span>
                                    <span class="course-card__price">@course.PriceDisplay</span>
                                </div>
                                <div class="course-card__actions">
                                    <a class="btn btn-outline-primary" href="@course.DetailsUrl">@T["CourseDetailsCTA"]</a>
                                    <form method="post" action="@course.AddToCartUrl" class="d-inline">
                                        <input type="hidden" name="courseId" value="@course.Id" />
                                        <button type="submit" class="btn btn-primary hero__cta">@T["CourseEnrollCTA"]</button>
                                    </form>
                                </div>
                            </div>
                        </article>
                    }
                }
                else
                {
                    <div class="course-card course-card--empty" data-reveal>
                        <p>@T["RecommendedEmpty"]</p>
                    </div>
                }
            </div>

            <aside class="courses__aside">
                <div class="insight-card" data-reveal data-reveal-delay="50">
                    <h3>@T["StartingSoon"]</h3>
                    <ul>
                        @foreach (var c in Model.FastSoonest)
                        {
                            <li>
                                <a asp-page="/Courses/Details" asp-route-id="@c.Id">@c.Title</a>
                                <span>@c.Date.ToString("d")</span>
                            </li>
                        }
                    </ul>
                    <a class="btn btn-outline-light hero__secondary" href="/Courses/Calendar">
                        <i class="bi bi-calendar3" aria-hidden="true"></i>
                        @T["CalendarButton"]
                    </a>
                </div>

                <div class="insight-card" data-reveal data-reveal-delay="100">
                    <h3>@T["NewsHeading"]</h3>
                    <div class="news-chips">
                        @foreach (var article in Model.FreshNews)
                        {
                            <a class="news-chip" asp-page="/Articles/Details" asp-route-id="@article.Id">@article.Title</a>
                        }
                    </div>
                </div>
            </aside>
        </div>
    </section>

    @if (Model.FeaturedTestimonials.Any())
    {
        <section class="section testimonials">
            <header class="section__header" data-reveal>
                <span class="section__eyebrow">@T["WhyChooseHeading"]</span>
                <h2>@T["TestimonialsHeading"]</h2>
                <p>@T["WhyChooseDescription"]</p>
            </header>
            <div class="testimonial-carousel" data-reveal>
                @foreach (var testimonial in Model.FeaturedTestimonials)
                {
                    <blockquote class="testimonial-card">
                        <p>“@testimonial.Quote”</p>
                        <footer>
                            <strong>@testimonial.FullName</strong>
                            @if (!string.IsNullOrWhiteSpace(testimonial.Position))
                            {
                                <span>@testimonial.Position</span>
                            }
                            @if (!string.IsNullOrWhiteSpace(testimonial.Company))
                            {
                                <span>@testimonial.Company</span>
                            }
                        </footer>
                    </blockquote>
                }
            </div>
        </section>
    }

    <section class="section why-us" id="why-us">
        <header class="section__header" data-reveal>
            <h2>@T["WhyChooseHeading"]</h2>
            <p>@T["WhyChooseDescription"]</p>
        </header>
        <div class="why-us__grid">
            <article class="why-us__card" data-reveal>
                <div class="why-us__icon"><i class="bi bi-briefcase" aria-hidden="true"></i></div>
                <h3>@T["HeroUSP1"]</h3>
                <p>@T["StepSelectDescription"]</p>
            </article>
            <article class="why-us__card" data-reveal data-reveal-delay="50">
                <div class="why-us__icon"><i class="bi bi-bullseye" aria-hidden="true"></i></div>
                <h3>@T["HeroUSP2"]</h3>
                <p>@T["StepRegisterDescription"]</p>
            </article>
            <article class="why-us__card" data-reveal data-reveal-delay="100">
                <div class="why-us__icon"><i class="bi bi-people" aria-hidden="true"></i></div>
                <h3>@T["HeroUSP3"]</h3>
                <p>@T["StepPayDescription"]</p>
            </article>
        </div>
    </section>

    <section class="section about" id="about">
        <div class="about__card" data-reveal>
            <h2>@T["AboutHeading"]</h2>
            <p>@T["HeroSubheading"]</p>
            <a class="btn btn-light hero__cta" href="/About">@T["AboutCtaLabel"]</a>
        </div>
    </section>

    <section class="section contact" id="contact">
        <header class="section__header" data-reveal>
            <span class="section__eyebrow">@T["ContactCtaHeading"]</span>
            <h2>@T["ContactHeading"]</h2>
            <p>@T["ContactDescription"]</p>
        </header>
        <div class="contact__grid">
            <article class="contact-card" data-reveal>
                <div class="contact-card__icon">
                    <i class="bi bi-telephone" aria-hidden="true"></i>
                </div>
                <div>
                    <h3>@T["ContactPhoneLabel"]</h3>
                    <p>@T["ContactPhoneValue"]</p>
                </div>
            </article>
            <article class="contact-card" data-reveal data-reveal-delay="50">
                <div class="contact-card__icon">
                    <i class="bi bi-envelope" aria-hidden="true"></i>
                </div>
                <div>
                    <h3>@T["ContactEmailLabel"]</h3>
                    <p>@T["ContactEmailValue"]</p>
                </div>
            </article>
            <article class="contact-card" data-reveal data-reveal-delay="100">
                <div class="contact-card__icon">
                    <i class="bi bi-geo-alt" aria-hidden="true"></i>
                </div>
                <div>
                    <h3>@T["ContactAddressLabel"]</h3>
                    <p>@T["ContactAddressValue"]</p>
                </div>
            </article>
        </div>
    </section>

</div>

@section Scripts {
    <script src="~/js/landing-page.js" asp-append-version="true"></script>
}
