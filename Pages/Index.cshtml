@page
@using System.Linq
@model IndexModel
@inject Microsoft.AspNetCore.Mvc.Localization.IViewLocalizer T
@inject SysJaky_N.Services.IsoStandards.IIsoSpecializationMetadataProvider IsoMetadataProvider
@{ 
    ViewData["Title"] = T["Title"];

    var specializations = IsoMetadataProvider.GetAll();

    var heroMediaSources = new Dictionary<string, string>
    {
        ["ISO9001"] = Url.Content("~/img/articles/iso9001-preparation.svg"),
        ["ISO14001"] = Url.Content("~/img/articles/process-management.svg"),
        ["ISOIEC17025"] = Url.Content("~/img/articles/internal-audit.svg"),
        ["ISO27001"] = Url.Content("~/img/articles/cert-vs-accred.svg"),
        ["ISO45001"] = Url.Content("~/img/articles/automotive-iso.svg")
    };

    var heroMedia = specializations
        .Where(item => heroMediaSources.ContainsKey(item.Key))
        .Take(3)
        .Select((item, index) => new
        {
            item.Name,
            Image = heroMediaSources[item.Key],
            Accent = index switch
            {
                0 => "primary",
                1 => "secondary",
                _ => "tertiary"
            }
        })
        .ToList();
}

@section Head {
    <link rel="stylesheet" href="~/css/home.css" asp-append-version="true" />
}

<div class="landing-page">
    <section class="landing-hero">
        <div class="landing-hero__inner">
            <div class="landing-hero__copy">
                <span class="eyebrow-pill">
                    <i class="bi bi-stars" aria-hidden="true"></i>
                    @T["HeroUSP2"]
                </span>
                <h1>@T["HeroMainHeading"]</h1>
                <p class="lead">@T["HeroSubheading"]</p>

                <div class="landing-hero__usp">
                    <span>
                        <i class="bi bi-patch-check" aria-hidden="true"></i>
                        @T["HeroUSP1"]
                    </span>
                    <span>
                        <i class="bi bi-people" aria-hidden="true"></i>
                        @T["HeroUSP3"]
                    </span>
                </div>

                <div class="landing-hero__actions">
                    <a class="btn btn-primary btn-gradient" href="/Courses/Index">
                        <span>@T["HeroPrimaryCTA"]</span>
                        <i class="bi bi-arrow-right" aria-hidden="true"></i>
                    </a>
                    <a class="btn btn-outline-light btn-soft" href="/Corporate">
                        @T["HeroSecondaryCTA"]
                    </a>
                </div>

                <div class="landing-hero__chips" aria-label="@T["HeroTitle"]">
                    <span class="chip">@T["ChipOnline"]</span>
                    <span class="chip">@T["ChipRetraining"]</span>
                    <span class="chip">@T["ChipCertificate"]</span>
                    <span class="chip">@T["ChipAccreditation"]</span>
                    <span class="chip">@T["ChipInternalAudits"]</span>
                </div>
            </div>

            <aside class="landing-hero__panel" aria-label="@T["HeroSearchLabel"]">
                @if (heroMedia.Any())
                {
                    <div class="landing-hero__media" aria-hidden="true">
                        @foreach (var media in heroMedia)
                        {
                            <figure class="media-tile media-tile--@media.Accent">
                                <img src="@media.Image" alt="" loading="lazy" decoding="async" />
                                <figcaption>@media.Name</figcaption>
                            </figure>
                        }
                    </div>
                }
                <div class="certificate-card">
                    <div class="certificate-card__header">
                        <div class="certificate-card__badge">
                            <i class="bi bi-shield-check" aria-hidden="true"></i>
                        </div>
                        <div>
                            <div class="certificate-card__eyebrow">@T["TrustGuarantee"]</div>
                            <div class="certificate-card__title">ISO 9001</div>
                        </div>
                    </div>
                    <div class="certificate-card__progress">
                        <div class="progress-group">
                            <div class="progress-label">@T["HeroUSP1"]</div>
                            <div class="progress-bar"><span style="--progress: 92%"></span></div>
                        </div>
                        <div class="progress-group">
                            <div class="progress-label">@T["HeroUSP2"]</div>
                            <div class="progress-bar"><span style="--progress: 78%"></span></div>
                        </div>
                        <div class="progress-group">
                            <div class="progress-label">@T["HeroUSP3"]</div>
                            <div class="progress-bar"><span style="--progress: 85%"></span></div>
                        </div>
                    </div>
                </div>

                <form class="landing-search" method="get" action="/Courses/Search" role="search">
                    <label class="visually-hidden" for="hero-search-input">@T["HeroSearchLabel"]</label>
                    <div class="landing-search__field">
                        <i class="bi bi-search" aria-hidden="true"></i>
                        <input type="search"
                               id="hero-search-input"
                               name="query"
                               placeholder="@T["HeroSearchPlaceholder"]"
                               aria-label="@T["HeroSearchAriaLabel"]" />
                    </div>
                    <button type="submit" class="btn btn-primary btn-gradient">@T["HeroSubmit"]</button>
                </form>

                <dl class="landing-hero__insights">
                    <div>
                        <dt><i class="bi bi-award" aria-hidden="true"></i></dt>
                        <dd>@Html.Raw(T["TrustRating", "<strong>4.8/5</strong>"])</dd>
                    </div>
                    <div>
                        <dt><i class="bi bi-people" aria-hidden="true"></i></dt>
                        <dd>@Html.Raw(T["TrustGraduates", "<strong>10 000+</strong>"])</dd>
                    </div>
                    <div>
                        <dt><i class="bi bi-patch-check" aria-hidden="true"></i></dt>
                        <dd>@T["TrustCertificate"]</dd>
                    </div>
                </dl>
            </aside>
        </div>

        <div class="landing-hero__metrics" aria-label="@T["WhyChooseHeading"]">
            <article>
                <span class="metric-value">20+</span>
                <span class="metric-label">@T["MetricExperienceLabel"]</span>
            </article>
            <article>
                <span class="metric-value">500+</span>
                <span class="metric-label">@T["MetricClientsLabel"]</span>
            </article>
            <article>
                <span class="metric-value">2000+</span>
                <span class="metric-label">@T["MetricCoursesLabel"]</span>
            </article>
            <article>
                <span class="metric-value">15+</span>
                <span class="metric-label">@T["MetricInstructorsLabel"]</span>
            </article>
        </div>
    </section>

    <section class="landing-section specializations" id="specializations">
        <header class="section-header">
            <span class="section-eyebrow">@T["HeroTitle"]</span>
            <h2>@T["SpecializationsHeading"]</h2>
            <p>@T["SpecializationsDescription"]</p>
        </header>
        <div class="specialization-list">
            @foreach (var specialization in specializations)
            {
                <article class="specialization-card">
                    <div class="specialization-card__icon @specialization.IconColorClass" aria-hidden="true">
                        <i class="@specialization.CardIconClass"></i>
                    </div>
                    <div class="specialization-card__body">
                        <h3>@specialization.Name</h3>
                        <p>@specialization.Summary</p>
                    </div>
                </article>
            }
        </div>
    </section>

    <section class="landing-section courses" id="courses">
        <header class="section-header">
            <span class="section-eyebrow">@T["RecommendedForYou"]</span>
            <h2>@T["CoursesHeading"]</h2>
            <p>@T["CoursesDescription"]</p>
        </header>

        <div class="courses-grid">
            @if (Model.PicksForPersona.Any())
            {
                foreach (var course in Model.PicksForPersona)
                {
                    <article class="course-pill">
                        <div class="course-pill__header">
                            <h3>@course.Title</h3>
                            <span class="badge">@course.Level</span>
                        </div>
                        <div class="course-pill__meta">
                            <span><i class="bi bi-broadcast" aria-hidden="true"></i>@course.Mode</span>
                            <span><i class="bi bi-geo-alt" aria-hidden="true"></i>@course.Type</span>
                            <span><i class="bi bi-calendar" aria-hidden="true"></i>@course.DateDisplay</span>
                        </div>
                        <div class="course-pill__footer">
                            <div>
                                <div class="course-pill__duration">@course.DurationDisplay</div>
                                <div class="course-pill__price">@course.PriceDisplay</div>
                            </div>
                            <div class="course-pill__actions">
                                <a class="btn btn-outline-primary" href="@course.DetailsUrl">@T["CourseDetailsCTA"]</a>
                                <form method="post" action="@course.AddToCartUrl" class="d-inline">
                                    <input type="hidden" name="courseId" value="@course.Id" />
                                    <button type="submit" class="btn btn-primary btn-gradient">@T["CourseEnrollCTA"]</button>
                                </form>
                            </div>
                        </div>
                    </article>
                }
            }
            else
            {
                <div class="course-empty">@T["RecommendedEmpty"]</div>
            }
        </div>

        <aside class="courses-sidebar">
            <div class="sidebar-card">
                <h3>@T["StartingSoon"]</h3>
                <ul>
                    @foreach (var c in Model.FastSoonest)
                    {
                        <li>
                            <a asp-page="/Courses/Details" asp-route-id="@c.Id">@c.Title</a>
                            <span>@c.Date.ToString("d")</span>
                        </li>
                    }
                </ul>
                <a class="btn btn-outline-light btn-soft" href="/Courses/Calendar">
                    <i class="bi bi-calendar3" aria-hidden="true"></i>
                    @T["CalendarButton"]
                </a>
            </div>

            <div class="sidebar-card">
                <h3>@T["NewsHeading"]</h3>
                <div class="news-chips">
                    @foreach (var article in Model.FreshNews)
                    {
                        <a class="news-chip" asp-page="/Articles/Details" asp-route-id="@article.Id">@article.Title</a>
                    }
                </div>
            </div>
        </aside>
    </section>

    @if (Model.FeaturedTestimonials.Any())
    {
        <section class="landing-section testimonials">
            <header class="section-header">
                <span class="section-eyebrow">@T["WhyChooseHeading"]</span>
                <h2>@T["TestimonialsHeading"]</h2>
                <p>@T["WhyChooseDescription"]</p>
            </header>
            <div class="testimonial-grid">
                @foreach (var testimonial in Model.FeaturedTestimonials)
                {
                    <blockquote class="testimonial-card">
                        <p>“@testimonial.Quote”</p>
                        <footer>
                            <strong>@testimonial.FullName</strong>
                            @if (!string.IsNullOrWhiteSpace(testimonial.Position))
                            {
                                <span>@testimonial.Position</span>
                            }
                            @if (!string.IsNullOrWhiteSpace(testimonial.Company))
                            {
                                <span>@testimonial.Company</span>
                            }
                        </footer>
                    </blockquote>
                }
            </div>
        </section>
    }

    <section class="landing-section about" id="about">
        <div class="about-card">
            <h2>@T["AboutHeading"]</h2>
            <p>@T["HeroSubheading"]</p>
            <a class="btn btn-light" href="/About">@T["AboutCtaLabel"]</a>
        </div>
    </section>

    <section class="landing-section why-us" id="why-us">
        <header class="section-header">
            <h2>@T["WhyChooseHeading"]</h2>
            <p>@T["WhyChooseDescription"]</p>
        </header>
        <div class="why-us__grid">
            <article class="why-us__card">
                <div class="why-us__icon"><i class="bi bi-briefcase" aria-hidden="true"></i></div>
                <h3>@T["HeroUSP1"]</h3>
                <p>@T["StepSelectDescription"]</p>
            </article>
            <article class="why-us__card">
                <div class="why-us__icon"><i class="bi bi-bullseye" aria-hidden="true"></i></div>
                <h3>@T["HeroUSP2"]</h3>
                <p>@T["StepRegisterDescription"]</p>
            </article>
            <article class="why-us__card">
                <div class="why-us__icon"><i class="bi bi-people" aria-hidden="true"></i></div>
                <h3>@T["HeroUSP3"]</h3>
                <p>@T["StepPayDescription"]</p>
            </article>
        </div>
    </section>

    <section class="landing-section contact" id="contact">
        <header class="section-header">
            <span class="section-eyebrow">@T["ContactCtaHeading"]</span>
            <h2>@T["ContactHeading"]</h2>
            <p>@T["ContactDescription"]</p>
        </header>
        <div class="contact-grid">
            <article class="contact-card">
                <div class="contact-icon"><i class="bi bi-telephone" aria-hidden="true"></i></div>
                <h3>@T["ContactPhoneLabel"]</h3>
                <p>@T["ContactPhoneValue"]</p>
            </article>
            <article class="contact-card">
                <div class="contact-icon"><i class="bi bi-envelope" aria-hidden="true"></i></div>
                <h3>@T["ContactEmailLabel"]</h3>
                <p>@T["ContactEmailValue"]</p>
            </article>
            <article class="contact-card">
                <div class="contact-icon"><i class="bi bi-geo-alt" aria-hidden="true"></i></div>
                <h3>@T["ContactAddressLabel"]</h3>
                <p>@T["ContactAddressValue"]</p>
            </article>
        </div>
    </section>

</div>
