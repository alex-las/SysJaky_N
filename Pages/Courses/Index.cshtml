@page
@model SysJaky_N.Pages.Courses.IndexModel
@{
    ViewData["Title"] = "Kurzy a školení";
}

<h1 class="mb-3">Kurzy a školení</h1>

<ul class="nav nav-pills mb-3">
    <li class="nav-item"><a class="nav-link active" asp-page="/Courses/Index">Seznam</a></li>
    <li class="nav-item"><a class="nav-link" asp-page="/Courses/Calendar">Kalendář</a></li>
</ul>

<div class="result-header sticky-top z-2 d-flex flex-wrap align-items-center justify-content-between gap-2 mb-3 py-2 bg-body border-bottom">
    <div class="small text-muted">
        @Model.TotalCount výsledků
        @if (!string.IsNullOrWhiteSpace(Context.Request.Query["persona"]))
        {
            <span class="ms-2 badge bg-primary-subtle text-primary">@(Context.Request.Query["persona"])</span>
        }
        @if (!string.IsNullOrWhiteSpace(Context.Request.Query["goal"]))
        {
            <span class="ms-1 badge bg-warning">@((string)Context.Request.Query["goal"])</span>
        }
    </div>
    <div class="d-flex gap-2">
        <a class="btn btn-sm btn-outline-secondary" href="@Url.Page("/Courses/Index")">Zrušit filtry</a>
        <a class="btn btn-sm btn-outline-primary d-lg-none" data-bs-toggle="offcanvas" href="#filters"><i class="bi bi-sliders"></i> Filtry</a>
    </div>
</div>

@if (TempData["CartError"] is string cartError && !string.IsNullOrWhiteSpace(cartError))
{
    <div class="alert alert-danger" role="alert">@cartError</div>
}

@await Html.PartialAsync("/Pages/Courses/_Filters.cshtml", Model)

<div class="row g-3">
    <aside class="col-lg-3 d-none d-lg-block">
        <div class="feature-card p-3">
            @await Html.PartialAsync("/Pages/Courses/_FiltersForm.cshtml", Model)
        </div>
    </aside>
    <main class="col-lg-9">
        <div class="courses-grid">
            @foreach (var c in Model.Courses)
            {
                @await Html.PartialAsync("/Pages/Shared/Components/_CourseCard.cshtml", c)
            }
        </div>

        @if (Model.TotalPages > 1)
        {
            <nav class="mt-3" aria-label="Stránkování kurzů">
                <ul class="pagination">
                    <li class="page-item @(Model.PageNumber <= 1 ? "disabled" : "")">
                        <a class="page-link" asp-route-PageNumber="@(Model.PageNumber - 1)" asp-route-CourseGroupId="@Model.CourseGroupId" asp-route-SearchString="@Model.SearchString" asp-route-Level="@Model.Level" asp-route-Mode="@Model.Mode" asp-route-MinDuration="@Model.MinDuration" asp-route-MaxDuration="@Model.MaxDuration" asp-route-SelectedTagIds="@Model.SelectedTagIds">Předchozí</a>
                    </li>
                    <li class="page-item @(Model.PageNumber >= Model.TotalPages ? "disabled" : "")">
                        <a class="page-link" asp-route-PageNumber="@(Model.PageNumber + 1)" asp-route-CourseGroupId="@Model.CourseGroupId" asp-route-SearchString="@Model.SearchString" asp-route-Level="@Model.Level" asp-route-Mode="@Model.Mode" asp-route-MinDuration="@Model.MinDuration" asp-route-MaxDuration="@Model.MaxDuration" asp-route-SelectedTagIds="@Model.SelectedTagIds">Další</a>
                    </li>
                </ul>
            </nav>
        }
    </main>
</div>
