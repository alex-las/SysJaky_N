@model SysJaky_N.Models.Course
@inject Microsoft.AspNetCore.Mvc.Localization.IViewLocalizer Localizer
<div class="feature-card h-100 p-3 d-flex flex-column justify-content-between" role="article" aria-label="@Model.Title">
  <div class="d-flex flex-column gap-2">
    @if (!string.IsNullOrWhiteSpace(Model.CoverImageUrl)){
      @{ var separator = Model.CoverImageUrl.Contains('?') ? "&" : "?"; var baseUrl = Model.CoverImageUrl + separator; }
      <picture>
        <source type="image/webp" srcset="@($"{baseUrl}w=480&format=webp 480w, {baseUrl}w=768&format=webp 768w, {baseUrl}w=1200&format=webp 1200w")" sizes="(max-width: 768px) 100vw, 480px" />
        <img src="@($"{baseUrl}w=768&format=jpg")" srcset="@($"{baseUrl}w=480&format=jpg 480w, {baseUrl}w=768&format=jpg 768w, {baseUrl}w=1200&format=jpg 1200w")" sizes="(max-width: 768px) 100vw, 480px" alt="@Localizer["CourseImageAlt", Model.Title]" class="img-fluid rounded mb-2" loading="lazy" decoding="async" />
      </picture>
    }
    <h3 class="h5 mb-1">@Model.Title</h3>
    @if (!string.IsNullOrWhiteSpace(Model.Description)){
      <p class="text-muted small mb-2">@Model.Description</p>
    }
    <div class="d-flex flex-wrap gap-2 align-items-center small">
      <span class="badge badge-soft-primary"><i class="bi bi-bar-chart me-1"></i>@Model.Level</span>
      <span class="badge badge-soft-primary"><i class="bi bi-laptop me-1"></i>@Model.Mode</span>
      <span class="badge badge-soft-accent"><i class="bi bi-geo-alt me-1"></i>@Model.Type</span>
      <span class="badge badge-soft-accent"><i class="bi bi-clock me-1"></i>@Model.Duration&nbsp;min</span>
    </div>
  </div>
  <div class="d-flex justify-content-between align-items-end mt-3">
    <div class="small text-muted">
      <div class="d-flex align-items-center">
        <i class="bi bi-calendar2 me-2" aria-hidden="true"></i>
        <small class="text-muted">
          <span aria-label='@Localizer["CourseDateAria", Model.Date.ToString("d")]'>@Model.Date.ToString("d")</span>
          @if (!string.IsNullOrWhiteSpace(Model.PopoverHtml))
          {
            <a tabindex="0" role="button" class="ms-1 text-decoration-dotted" data-bs-toggle="popover" data-bs-html="true" data-bs-content="@Model.PopoverHtml" aria-label='@Localizer["CourseAdditionalInfoAria", Model.Title]'>
              <i class="bi bi-info-circle" aria-hidden="true"></i>
            </a>
          }
        </small>
      </div>
      <div class="fw-semibold">@Model.Price.ToString("C")</div>
    </div>
    <div class="d-flex flex-column align-items-end gap-2">
      <div class="form-check form-check-inline">
        <input class="form-check-input cmp-check" type="checkbox" value="@Model.Id" id="cmp_@Model.Id">
        <label class="form-check-label small" for="cmp_@Model.Id">@Localizer["Compare"]</label>
      </div>
      <div class="d-flex gap-2">
        <a class="btn btn-outline-secondary" asp-page="/Courses/Details" asp-route-id="@Model.Id">@Localizer["Details"]</a>
        <form method="post" asp-page="/Courses/Index" asp-page-handler="AddToCart" class="d-inline">
          <input type="hidden" name="courseId" value="@Model.Id" />
          <button type="submit" class="btn btn-primary" aria-label="@Localizer["EnrollAriaLabel", Model.Title]">@Localizer["Enroll"]</button>
        </form>
      </div>
    </div>
  </div>
</div>
