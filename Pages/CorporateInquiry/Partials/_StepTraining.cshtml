@model SysJaky_N.Pages.CorporateInquiryModel
@inject Microsoft.AspNetCore.Mvc.Localization.IViewLocalizer Localizer

<h2 class="h4 mb-3">@Localizer["Step1Title"]</h2>
<p class="text-muted mb-4">@Localizer["Step1Description"]</p>

<div class="mb-3" role="group" aria-labelledby="trainingTypesLabel">
    <span id="trainingTypesLabel" class="form-label d-block fw-semibold">@Localizer["TrainingTypesLabel"]</span>
    @for (var index = 0; index < Model.IsoTrainingOptionKeys.Count; index++)
    {
        var key = Model.IsoTrainingOptionKeys[index];
        var inputId = $"iso-option-{index}";
        <div class="form-check">
            <input class="form-check-input" type="checkbox" id="@inputId" name="Input.TrainingTypes" value="@key" @(Model.Input.TrainingTypes.Contains(key) ? "checked" : null) />
            <label class="form-check-label" for="@inputId">@Localizer[key]</label>
        </div>
    }
    @{
        var trainingError = ViewData.ModelState.TryGetValue("Input.TrainingTypes", out var trainingState) && trainingState.Errors.Count > 0
            ? trainingState.Errors[0].ErrorMessage
            : null;
        var errorClass = string.IsNullOrEmpty(trainingError) ? "d-none" : string.Empty;
    }
    <div id="training-types-error" class="invalid-feedback d-block @errorClass">@trainingError</div>
</div>

@{
    var packageKeys = new[] { "PackageIso9001Full", "PackageImsIntegrated", "PackageLabAccreditation" };
}

<div class="mt-4">
    <h3 class="h5 mb-3">@Localizer["PackageRecommendationsTitle"]</h3>
    <div class="row g-3">
        @foreach (var packageKey in packageKeys)
        {
            var localized = Localizer[packageKey].Value ?? string.Empty;
            var parts = localized.Split(new[] { "\r\n", "\n" }, System.StringSplitOptions.RemoveEmptyEntries);
            var title = parts.Length > 0 ? parts[0] : localized;
            var description = parts.Length > 1 ? string.Join(" ", parts, 1, parts.Length - 1) : string.Empty;
            <div class="col-12 col-md-4">
                <div class="border rounded p-3 h-100">
                    <div class="fw-semibold mb-2">@title</div>
                    @if (!string.IsNullOrEmpty(description))
                    {
                        <p class="mb-0 text-muted">@description</p>
                    }
                </div>
            </div>
        }
    </div>
</div>
